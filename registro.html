<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario de Registro</title>
    <link rel="stylesheet" href="estilos.css">
</head>
<body>

    <div class="form-container">
        <h1>Registro de Usuario (con validación JS)</h1>
        <p>Completa el formulario para registrarte. Todos los campos son obligatorios.</p>

        <form id="registro-form" novalidate>
            <!-- Nombre de usuario -->
            <div class="form-group">
                <label for="username">Nombre de usuario</label>
                <input type="text" id="username" name="username" required>
                <div class="error-message" id="error-username"></div>
            </div>

            <!-- Email -->
            <div class="form-group">
                <label for="email">Correo electrónico</label>
                <input type="email" id="email" name="email" required>
                <div class="error-message" id="error-email"></div>
            </div>

            <!-- Contraseña -->
            <div class="form-group">
                <label for="password">Contraseña</label>
                <input type="password" id="password" name="password" required>
                <div class="error-message" id="error-password"></div>
            </div>

            <!-- Confirmar Contraseña -->
            <div class="form-group">
                <label for="confirm-password">Confirmar contraseña</label>
                <input type="password" id="confirm-password" name="confirm-password" required>
                <div class="error-message" id="error-confirm-password"></div>
            </div>
            
            <button type="submit" class="btn-primary">Registrarse</button>
        </form>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('registro-form');
            const username = document.getElementById('username');
            const email = document.getElementById('email');
            const password = document.getElementById('password');
            const confirmPassword = document.getElementById('confirm-password');

            function noEstaVacio(valor) {
                return valor.trim() !== '';
            }

            function esCorreoValido(correo) {
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return emailRegex.test(correo);
            }

            function tieneFuerzaContraseña(contraseña) {
                if (contraseña.length < 8) return false;
                const tieneLetra = /[a-zA-Z]/.test(contraseña);
                const tieneNumero = /\d/.test(contraseña);
                return tieneLetra && tieneNumero;
            }

            function coincidenContraseñas(contraseña1, contraseña2) {
                return contraseña1 === contraseña2;
            }

            function mostrarError(campo, mensaje) {
                const errorDiv = document.getElementById(`error-${campo.id}`);
                errorDiv.textContent = mensaje;
                campo.classList.add('is-invalid');
            }

            function limpiarError(campo) {
                const errorDiv = document.getElementById(`error-${campo.id}`);
                errorDiv.textContent = '';
                campo.classList.remove('is-invalid');
            }

            username.addEventListener('blur', function() {
                if (!noEstaVacio(username.value)) {
                    mostrarError(username, 'El nombre de usuario es obligatorio.');
                } else {
                    limpiarError(username);
                }
            });

            email.addEventListener('blur', function() {
                if (!noEstaVacio(email.value)) {
                    mostrarError(email, 'El correo electrónico es obligatorio.');
                } else if (!esCorreoValido(email.value)) {
                    mostrarError(email, 'El formato del correo no es válido.');
                } else {
                    limpiarError(email);
                }
            });

            password.addEventListener('blur', function() {
                if (!noEstaVacio(password.value)) {
                    mostrarError(password, 'La contraseña es obligatoria.');
                } else if (!tieneFuerzaContraseña(password.value)) {
                    mostrarError(password, 'La contraseña debe tener al menos 8 caracteres, incluyendo una letra y un número.');
                } else {
                    limpiarError(password);
                }
            });

            confirmPassword.addEventListener('blur', function() {
                if (!noEstaVacio(confirmPassword.value)) {
                    mostrarError(confirmPassword, 'Debes confirmar la contraseña.');
                } else if (!coincidenContraseñas(password.value, confirmPassword.value)) {
                    mostrarError(confirmPassword, 'Las contraseñas no coinciden.');
                } else {
                    limpiarError(confirmPassword);
                }
            });

            function validarFormulario() {
                let esValido = true;
                if (!noEstaVacio(username.value)) { mostrarError(username, 'El nombre de usuario es obligatorio.'); esValido = false; }
                if (!esCorreoValido(email.value)) { mostrarError(email, 'El formato del correo no es válido.'); esValido = false; }
                if (!tieneFuerzaContraseña(password.value)) { mostrarError(password, 'La contraseña debe tener al menos 8 caracteres, incluyendo una letra y un número.'); esValido = false; }
                if (!coincidenContraseñas(password.value, confirmPassword.value)) { mostrarError(confirmPassword, 'Las contraseñas no coinciden.'); esValido = false; }
                return esValido;
            }
            
            form.addEventListener('submit', function(event) {
                event.preventDefault();
                if (validarFormulario()) {
                    alert('¡Formulario de registro enviado con éxito!');
                    form.reset();
                } else {
                    console.log('Formulario con errores.');
                }
            });
        });
    </script>
</body>
</html>
